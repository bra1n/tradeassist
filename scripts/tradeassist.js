(function(){var t,e,i,n,s,r,a,o={}.hasOwnProperty,u=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};$(document).ready(function(){var e;return e=new t,e.addCardInterface($("#left")),e.addCardInterface($("#right"))}),e=function(){function t(){}return t.prototype.defaultImg="images/spacer.gif",t.prototype.regularImageUrl="http://gatherer.wizards.com/Handlers/Image.ashx?",t.prototype.customImageUrl="http://www.mkmapi.eu/img/cards/",t.prototype.url="bridge.php",t.prototype.events={},t.prototype.test="",t.prototype.tradeAssist=null,t.prototype.addEvent=function(t,e){return null!=t&&null!=e&&(this.events[t]=this.events[t]||[],this.events[t].push(e)),this},t.prototype.removeEvents=function(t){return this.events[t]=[],this},t.prototype.fireEvent=function(t,e){var i,n,s,r;if(null!=this.events[t])for(r=this.events[t],n=0,s=r.length;s>n;n++)i=r[n],i.apply(this,e);return this},t}(),t=function(t){function e(){this.region="eu",null!=(navigator.language||navigator.userLanguage||"").match(RegExp("^en-us","i"))&&(this.region="us"),$("body").addClass("region-"+this.region),""!==window.location.hash&&this.loadLists(window.location.hash.substr(1)),$("#controlicons").length&&($("#controlicons .save").on("click",function(t){return function(){return t.saveLists()}}(this)),$("#controlicons .price").on("click",function(t){return function(){return t.togglePrices()}}(this)),$("#controlicons .region").on("click",function(t){return function(){return t.toggleRegion()}}(this))),$("#container > div").on("click",".counter",function(){return $(this).closest(".inactive").removeClass("inactive").siblings("div").addClass("inactive")}),this.popup=$("#popup").on("click",".window",function(){return $(this).stop().fadeOut(function(){return $(this).remove()})}).find(".window"),this.isMobile="block"===$("#left").css("display")}return u(e,t),e.prototype.cardInterfaces=[],e.prototype.requestRunning=!1,e.prototype.isMobile=!1,e.prototype.isMinimum=!1,e.prototype.addCardInterface=function(t){return this.cardInterfaces.push(new n(t,this))},e.prototype.saveLists=function(){var t,e,i,n,s,r;for(i=[],r=this.cardInterfaces,e=n=0,s=r.length;s>n;e=++n)t=r[e],i[e]=t.cardlist.exportToObject();return this.requestRunning?void 0:(this.requestRunning=!0,$.post(this.url,{action:"export",arg:JSON.stringify(i)},function(t){return function(e){var i;return e&&(window.location.hash=e,i=window.location.toString(),t.showPopup("List saved",'List has been saved and can be shared with this URL:<br/><a href="'+i+'">'+i+"</a>")),t.requestRunning=!1}}(this)))},e.prototype.loadLists=function(t){return this.requestRunning?void 0:(this.requestRunning=!0,$.getJSON(this.url,{action:"import",arg:t},function(t){return function(e){return null!=e&&$.each(e,function(e,i){var n;return null!=(n=t.cardInterfaces[e])?n.cardlist.reset().importFromObject(i):void 0}),t.requestRunning=!1}}(this)))},e.prototype.togglePrices=function(){var t,e,i,n;for(this.isMinimum=!this.isMinimum,$("body").toggleClass("price-min",this.isMinimum),n=this.cardInterfaces,e=0,i=n.length;i>e;e++)t=n[e],t.cardlist.updatePrices();return this.showPopup("Switched Prices","The cards are now compared by <em>"+(this.isMinimum?"minimum":"average")+" prices</em>")},e.prototype.toggleRegion=function(){var t,e,i,n;for($("body").removeClass("region-"+this.region),this.region="us"===this.region?"eu":"us",$("body").addClass("region-"+this.region),n=this.cardInterfaces,e=0,i=n.length;i>e;e++)t=n[e],t.cardlist.reset();return this.showPopup("Switched Region","Changed the price region to <em>"+this.region.toUpperCase()+"</em>")},e.prototype.showPopup=function(t,e){return this.popup.clone().find("h1").text(t).end().find("p").html(e).end().appendTo("#popup").slideDown().delay(2500).fadeOut(function(){return $(this).remove()})},e}(e),i=function(t){function e(t,i){var n,s,r,a;if(this.tradeAssist=i,$.isArray(t)){for(n=r=0,a=t.length;a>r;n=++r)s=t[n],t[n]=new e(s,this.tradeAssist);return t}return this.name={en:t.name||"",de:t.name_de||""},this.printings=t.printings,this.rates={normal:t.rate||-1,foil:t.rate_foil||-1,min:t.minprice||-1,min_foil:t.minprice_foil||-1,date:"",special:""},this.count=t.count||1,this.isFoil=t.foil||!1,this.isMinimum=this.tradeAssist.isMinimum,this.events={},this}return u(e,t),e.prototype.getName=function(t){return null==t&&(t="en"),this.name[t]},e.prototype.getId=function(){return this.printings[0].id},e.prototype.getRarity=function(){return this.printings[0].rarity},e.prototype.getCount=function(){return this.count},e.prototype.setCount=function(t){var e;if(t=Math.max(0,t),t!==this.count){if(e=t-this.count,this.count=t,this.getRate()>=0)return this.fireEvent("valuechange",[e*this.getRate()]);if(0===t)return this.fireEvent("valuechange",[0])}},e.prototype.getIsFoil=function(){return this.isFoil},e.prototype.setIsFoil=function(t){var e;return t!==this.isFoil&&(e=this.getRate(),this.isFoil=t,e>=0&&this.getRate()>=0)?this.fireEvent("valuechange",[this.getCount()*(this.getRate()-e)]):void 0},e.prototype.updateRate=function(){var t;return this.isMinimum!==this.tradeAssist.isMinimum&&(t=this.getRate(),this.isMinimum=this.tradeAssist.isMinimum,t>=0&&this.getRate()>=0)?this.fireEvent("valuechange",[this.getCount()*(this.getRate()-t)]):void 0},e.prototype.getSpecial=function(){return this.rates.special},e.prototype.getImage=function(){var t;return t=this.defaultImg,""===this.printings[0].img?(t=this.regularImageUrl+"type=card&size=small&set=",t+=this.getEdition(!0)+"&name=",t+=encodeURIComponent(this.getName().replace(RegExp(" \\(.*?\\)","g"),""))):t=this.customImageUrl+this.printings[0].img,t},e.prototype.getEdition=function(t){return null==t&&(t=!1),t?this.printings[0].ed:this.printings[0].edition},e.prototype.getEditionImage=function(t){return null==t&&(t=!1),"images/editions/"+(t||this.getEdition(!0))+".png"},e.prototype.getEditions=function(){var t,e,i,n,s;for(t=[],s=this.printings,i=0,n=s.length;n>i;i++)e=s[i],t.push({"short":e.ed,"long":e.edition,src:this.getEditionImage(e.ed)});return t},e.prototype.setEdition=function(t){var e,i,n,s,r,a;if(i=0,""!==this.rates.date&&(this.printings[0].rates=this.rates,i=this.getRate()),"string"!=typeof t)t?this.printings.push(this.printings.shift()):this.printings.unshift(this.printings.pop());else for(a=this.printings,e=s=0,r=a.length;r>s;e=++s)n=a[e],n.ed===t&&this.printings.unshift(this.printings.splice(e,1)[0]);return null==this.printings[0].rates?(this.rates={normal:-1,foil:-1,min:-1,min_foil:-1,date:"",special:""},this.fireEvent("valuechange",[this.getCount()*-i])):(this.rates=this.printings[0].rates,"nofoil"===this.rates.special&&(this.isFoil=!1),"onlyfoil"===this.rates.special&&(this.isFoil=!0),this.getRate()>=0?this.fireEvent("valuechange",[this.getCount()*(this.getRate()-i)]):void 0)},e.prototype.getRate=function(){var t;return""===this.rates.date?(this.rates.special!==this.getId()&&(t=this.getId(),this.rates.special=t,$.getJSON(this.url,{action:"value",arg:t,region:this.tradeAssist.region},function(e){return function(i){return i.error||e.getId()!==t?(e.tradeAssist.showPopup("Error loading price",i.error),e.rates.normal=0,e.rates.foil=0,e.rates.min=0,e.rates.min_foil=0,e.rates.date=(new Date).getTime(),e.fireEvent("valuechange",[0])):(e.rates.normal=parseFloat(i.rate),e.rates.foil=parseFloat(i.rate_foil),e.rates.min=parseFloat(i.minprice),e.rates.min_foil=parseFloat(i.minprice_foil),e.rates.date=i.timestamp,e.rates.foil>0&&0===e.rates.normal?(e.rates.special="onlyfoil",e.isFoil=!0):0===e.rates.foil?(e.rates.special="nofoil",e.isFoil=!1):e.rates.special="",e.fireEvent("valuechange",[e.getRate()*e.getCount()]))}}(this))),-1):this.getIsFoil()?this.isMinimum?this.rates.min_foil:this.rates.foil:this.isMinimum?this.rates.min:this.rates.normal},e.prototype.getRateTimestamp=function(){return this.rates.date||null},e.prototype.getMKMLink=function(){return"http://www.magiccardmarket.eu/CardPage.c1p"+this.getId()+".prod?referrer=bra1n"},e.prototype.clone=function(){var t,i,n,s,r;for(t=new e({},this.tradeAssist),i=["name","printings","rates","count","isFoil","isMinimum"],s=0,r=i.length;r>s;s++)n=i[s],t[n]=this[n];return t},e}(e),n=function(t){function e(t,e){this.tradeAssist=e,this.sideContainer=$(t),this.input=this.sideContainer.find(".input_cardname"),this.difference=this.sideContainer.find(".difference"),this.lastSuggest="",this.counter=new a(this.sideContainer.find(".currentvalue"),this.tradeAssist),this.counter.addEvent("difference",function(t){return function(e,i){return t.differenceTimer&&window.clearTimeout(t.differenceTimer),t.differenceTimer=window.setTimeout(function(){return t.updateDifference(e,i)},250)}}(this)),this.tradeAssist.isMobile&&(this.input.on("focus",function(){return function(){return $("#controlpanel").hide()}}(this)),this.input.on("blur",function(){return function(){return $("#controlpanel").show()}}(this))),this.cardlist=new s(this.sideContainer.find(".cardlist_container"),this.tradeAssist),this.cardlist.addEvent("valuechange",function(t){return function(e){return t.counter.add(e)}}(this)),this.suggestions=new r(this.input,this.tradeAssist),this.suggestions.addEvent("click",function(t){return function(e){return t.cardlist.addCard(e.clone()),t.suggestions.hide(),t.tradeAssist.isMobile||t.input.val("").focus(),t.lastSuggest=""}}(this)),this.input.on({keyup:function(t){return function(e){return t.inputKeyEvent(e.which)}}(this)})}return u(e,t),e.prototype.inputKeyEvent=function(t){switch(t){case 13:if(this.suggestions.isUp())return this.suggestions.fire(),this.input.val(""),this.lastSuggest="";if(""!==this.input.val())return this.lastSuggest=this.input.val(),this.suggestions.suggest(this.input.val());break;case 37:return this.suggestions.left();case 38:return this.suggestions.up();case 39:return this.suggestions.right();case 40:return this.suggestions.down();default:return this.suggestTimer&&window.clearTimeout(this.suggestTimer),this.suggestTimer=window.setTimeout(function(t){return function(){return t.input.val()!==t.lastSuggest?(t.lastSuggest=t.input.val(),t.suggestions.suggest(t.lastSuggest)):t.suggestions.isUp()?void 0:t.suggestions.show()}}(this),250)}},e.prototype.updateDifference=function(t,e){var n,s,r,a,o,u,c,l,h,d,p;if(Math.abs(.5-e)>.05&&!this.counter.isMax()&&t>0){for(s=[],h=this.tradeAssist.cardInterfaces,o=0,c=h.length;c>o;o++)if(a=h[o],a.counter.isMax())for(d=a.cardlist.exportToObject().cards,u=0,l=d.length;l>u;u++)n=d[u],s.push(n.id);return this.difference.addClass("show").find("span").text(t.toFixed(2).replace(/\./,",")),this.difference.find(".slider").css("width",100-100*e+"%"),r=this.difference.find(".propose").off("click"),null!=this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=$.getJSON(this.url,{action:"propose",arg:parseFloat(t).toFixed(2),exclude:s.join(","),minprice:this.tradeAssist.isMinimum,region:this.tradeAssist.region},function(t){return function(e){return e?(n=new i(e,t.tradeAssist),r.find("a").text(n.getName()+" ("+n.getEdition(!0)+")"),r.on("click","a",function(){return t.tradeAssist.isMobile&&t.sideContainer.removeClass("inactive").siblings("div").addClass("inactive"),t.cardlist.addCard(n),r.off("click"),!1}),r.show()):r.hide()}}(this))}return null!=(p=this.xhr)&&p.abort(),this.difference.removeClass("show").find(".propose").off("click")},e}(e),s=function(t){function e(t,e){var i;this.tradeAssist=e,this.cards=[],this.events={},i=this,this.sortElements=$('<div class="sort"><div class="title">sort by</div></div>'),this.sortElements.prepend($('<div class="name active down">name</div>').on("click",function(){return $(this).is(".active")||$(this).siblings(".active").removeClass("active").removeClass("down"),i.sort("name",$(this).addClass("active").toggleClass("down").hasClass("down"))})),this.sortElements.prepend($('<div class="rarity">rarity</div>').on("click",function(){return $(this).is(".active")||$(this).siblings(".active").removeClass("active").removeClass("down"),i.sort("rarity",$(this).addClass("active").toggleClass("down").hasClass("down"))})),this.sortElements.prepend($('<div class="rate">price</div>').on("click",function(){return $(this).is(".active")||$(this).siblings(".active").removeClass("active").removeClass("down"),i.sort("rate",$(this).addClass("active").toggleClass("down").hasClass("down"))})),this.sortElements.prepend($('<div class="reset">X</div>').on("click",function(t){return function(){return t.reset()}}(this))),this.sortElements.prepend($('<div class="cards"><strong>0</strong> cards</div>')),this.cardlist=$('<ul class="cardlist"></ul>'),$(t).append(this.sortElements).append(this.cardlist)}return u(e,t),e.prototype.addCard=function(t){var e;return null!=t?(e=this.generateCardTemplate(t),this.cardlist.append(e),this.cards.push(e.slideDown()),t.removeEvents("valuechange").addEvent("valuechange",function(t){return function(i){return t.handleValueChange(e,i)}}(this)),this.sort(this.sortElements.find(".active").text(),this.sortElements.find(".active").hasClass("down")),this.updateCounter()):void 0},e.prototype.sort=function(t,e){var i;switch(e=e&&1||-1,t){case"name":i=function(t,i){return $(t).data("card").getName().toLowerCase()>$(i).data("card").getName().toLowerCase()?e:-1*e};break;case"edition":i=function(t,i){return $(t).data("card").getEdition(!1)>$(i).data("card").getEdition(!1)?e:-1*e};break;case"rarity":i=function(t,i){var n;return n=["t","c","u","r","m","s"],n.indexOf($(t).data("card").getRarity())<n.indexOf($(i).data("card").getRarity())?e:-1*e};break;case"rate":case"price":i=function(t,i){return $(t).data("card").getRate()<$(i).data("card").getRate()?e:-1*e};break;default:i=function(){return 0}}return this.cardlist.find("li.card").length>0?this.cardlist.append(this.cardlist.find("li.card").sort(i)):void 0},e.prototype.reset=function(){var t,e,i,n,s,r;for(i=0,r=this.cards,n=0,s=r.length;s>n;n++)e=r[n],t=e.data("card"),t.removeEvents("valuechange"),i-=Math.max(0,t.getRate())*t.getCount(),e.slideUp(200,function(){return $(this).remove()});return this.fireEvent("valuechange",[i]),this.cards=[],this.updateCounter()},e.prototype.updateCounter=function(){var t,e,i,n,s;for(e=0,s=this.cards,i=0,n=s.length;n>i;i++)t=s[i],e+=t.data("card").getCount();return this.sortElements.find(".cards").html("<strong>"+e+"</strong> card"+(1===e?"":"s")),e&&this.sortElements.slideDown(),e||this.sortElements.slideUp(),this},e.prototype.exportToObject=function(){var t,e,i,n,s;for(e={cards:[]},s=this.cards,i=0,n=s.length;n>i;i++)t=s[i],e.cards.push({id:t.data("card").getId(),count:t.data("card").getCount(),foil:t.data("card").getIsFoil()});return e},e.prototype.importFromObject=function(t){var e,n,s,r;if(t.cards){for(r=t.cards,n=0,s=r.length;s>n;n++)e=r[n],this.addCard(new i(e,this.tradeAssist));return this.sort(this.sortElements.find(".active").text(),this.sortElements.find(".active").hasClass("down"))}},e.prototype.updatePrices=function(){var t,e,i,n,s;for(n=this.cards,s=[],e=0,i=n.length;i>e;e++)t=n[e],s.push(t.data("card").updateRate());return s},e.prototype.generateCardTemplate=function(t){var e,i,n;return n=this,e=$('<li class="card"></li>'),i=$('<div class="right"></div>'),i.append('<span class="count">'+t.getCount()+'x</span><span class="rate currency'+(t.getIsFoil()?" foil":"")+'"></span>'),i.append($('<button class="plus">+</button>').on("click",function(){return t.setCount(t.getCount()+1)})),i.append('<img class="rarity '+t.getRarity()+'" src="'+this.defaultImg+'" alt=""/><br/>'),i.append($('<img class="edition" alt="'+t.getEdition(!0)+'" title="'+t.getEdition(!1)+'" src="'+t.getEditionImage()+'"/>').on("click",function(){var n,s,r,a,o,u;if(t.getEditions().length>1){for(s=$('<div class="editions"></div>'),u=t.getEditions(),r=function(n){return s.prepend($('<img class="edition choice"/>').attr({alt:n.short,src:n.src,title:n.long}).on("click",function(){return s.remove(),t.setEdition(n.short),i.find(".edition").attr({alt:t.getEdition(!0),title:t.getEdition(!1),src:t.getEditionImage()}).show(),i.find(".rarity").attr("class","rarity "+t.getRarity()),e.find(".thumbnail").attr("src",t.getImage()).parent("a").attr("href",t.getMKMLink())}))},a=0,o=u.length;o>a;a++)n=u[a],r(n);return $(this).hide().after(s)}}).toggleClass("multiple",t.getEditions().length>1)),i.append($('<div class="checkbox foil" title="Normal / Foil"></div>').toggleClass("checked",t.getIsFoil()).on("click",function(){return $(this).hasClass("locked")?void 0:t.setIsFoil($(this).toggleClass("checked").hasClass("checked"))})),i.append($('<button class="minus">&ndash;</button>').on("click",function(){return t.setCount(t.getCount()-1)})),i.append('<img class="rarity '+t.getRarity()+'" src="'+this.defaultImg+'"/>'),e.append(i),e.append($('<a href="'+t.getMKMLink()+'" target="_blank"><img class="thumbnail" alt="'+t.getName()+'" title="'+t.getName()+'" src="'+t.getImage()+'"/></a>').on({mouseenter:function(){var t;if(!n.tradeAssist.isMobile)return t=$(this).find(".thumbnail"),$("#fullcard").stop().remove(),t.clone().attr("id","fullcard").css(t.offset()).css({left:t.offset().left-250,top:t.offset().top-100,display:"none"}).appendTo("body").fadeIn()},mouseleave:function(){return $("#fullcard").stop().fadeOut(500,function(){return $(this).remove()})}})),e.append('<div class="name">'+t.getName("en")+"</div>").data("card",t),t.getRate()>=0?this.handleValueChange(e,t.getRate()):i.find("span.rate").addClass("loader"),e},e.prototype.handleValueChange=function(t,e){var i,n,s,r,a,o;if(i=t.data("card"),0===i.getCount()){for(o=this.cards,n=r=0,a=o.length;a>r;n=++r)s=o[n],s===t&&this.cards.splice(n,1);t.slideUp(500,function(){return $(this).remove()})}else switch(i.getRate()<0?t.find("span.rate").addClass("loader").text("").attr("title",i.getRateTimestamp()):t.find("span.rate").removeClass("loader").text(i.getRate().toFixed(2).replace(/\./,",")).attr("title",i.getRateTimestamp()),t.find("span.rate").toggleClass("foil",i.getIsFoil()),t.find("span.count").text(i.getCount()+"x"),i.getSpecial()){case"onlyfoil":t.find(".name").addClass("foil"),t.find(".checkbox.foil").addClass("checked locked").attr("title","");break;case"nofoil":t.find(".name").removeClass("foil"),t.find(".checkbox.foil").addClass("locked").removeClass("checked");break;default:t.find(".name").toggleClass("foil",i.getIsFoil()),t.find(".checkbox.foil").removeClass("locked").toggleClass("checked",i.getIsFoil())}return this.updateCounter(),"price"===this.sortElements.find(".active").text()&&this.sort("rate",this.sortElements.find(".active").hasClass("down")),this.fireEvent("valuechange",[e])},e}(e),r=function(t){function e(t,e){this.tradeAssist=e,this.inputElement=$(t),this.container=$('<ul class="suggestions"></ul>'),this.events={}}return u(e,t),e.prototype.suggest=function(t){var e,n;return""!==t?(4!==(null!=(e=this.xhr)?e.readyState:void 0)&&null!=(n=this.xhr)&&n.abort(),this.xhr=$.getJSON(this.url,{action:"suggest",arg:t},function(e){return function(n){return t===e.lastSuggest?(null!=n?n.cards.length:void 0)>0?e.show(new i(n.cards,e.tradeAssist)):e.hide():void 0}}(this)),this.lastSuggest=t):this.hide()},e.prototype.show=function(t){var e,i,n,s,r,a,o,u,c,l;if(t)for(this.container.empty(),u=function(t){return function(e,i){return e.on({click:function(){return t.fireEvent("click",[i])},mouseenter:function(){return e.is(".active")?void 0:($("li.active",t.container).removeClass("active"),e.addClass("active"))}})}}(this),n=c=0,l=t.length;l>c;n=++c)e=t[n],s=$('<li class="suggestion'+(n?"":" active")+'"></li>').data("card",e),r="",i="",a=this.escapeRegExp(this.lastSuggest),!this.lastSuggest||new RegExp(a,"i").test(e.getName())?i=e.getName().replace(new RegExp("("+a+")","i"),"<em>$1</em>"):(i=e.getName("de").replace(new RegExp("("+a+")","i"),"<em>$1</em>"),r=e.getName()),s.append($("<span class='name'>"+i+"</span>")),""!==r&&s.append($("<span class='name_real'>("+r+")</span>")),s.append($("<img class='thumbnail'/>").attr({src:e.getImage(),title:e.getName(),alt:e.getName()})),s.prepend($("<img class='edition'/>").attr({src:e.getEditionImage(),title:e.getEdition(),alt:e.getEdition(!0)})),e.getEditions().length>1&&!function(t){return function(e){return e.prepend($('<div class="arrow left">&larr;</div>').on("click",function(i){return i.stopPropagation(),t.left(e)})),e.prepend($('<div class="arrow right">&rarr;</div>').on("click",function(i){return i.stopPropagation(),t.right(e)}))}}(this)(s),u(s,e),this.container.append(s);return!this.isUp()&&$("li.suggestion",this.container).length&&(this.inputElement.parent(".input").after(this.container),o=$(window),o.height()+o.scrollTop()<this.container.offset().top+this.container.outerHeight())?$("body").animate({scrollTop:this.inputElement.offset().top}):void 0},e.prototype.hide=function(){return this.isUp()?this.inputElement.parent(".input").next(".suggestions").detach():void 0},e.prototype.isUp=function(){return this.inputElement.parent(".input").next(".suggestions").length>0},e.prototype.fire=function(){return this.hide(),$("li.active",this.container).trigger("click")},e.prototype.down=function(){var t;if(!this.isUp())return this.show();if(!($("li.suggestion",this.container).length<=1))return t=$("li.active",this.container).removeClass("active"),0===t.next("li.suggestion").addClass("active").length?$("li.suggestion:first",this.container).addClass("active"):void 0},e.prototype.up=function(){var t;if(!this.isUp())return this.show();if(!($("li.suggestion",this.container).length<=1))return t=$("li.active",this.container).removeClass("active"),0===t.prev("li.suggestion").addClass("active").length?$("li.suggestion:last",this.container).addClass("active"):void 0},e.prototype.changeEdition=function(t,e){var i;return this.isUp()&&(null==t&&(t=$("li.active",this.container)),i=t.data("card"),i.getEditions().length>1)?(i.setEdition(e),this.tradeAssist.isMobile||$(".thumbnail",t).attr("src",i.getImage()),$(".edition",t).attr({alt:i.getEdition(!0),title:i.getEdition(),src:i.getEditionImage()})):void 0},e.prototype.left=function(t){return this.changeEdition(t,!1)},e.prototype.right=function(t){return this.changeEdition(t,!0)},e.prototype.escapeRegExp=function(t){return t.replace(/[-[\]{}()*+?.\\^$|,#\s]/g,function(t){return"\\"+t})},e}(e),a=function(t){function e(t,e){this.tradeAssist=e,this.counter=$(t).text("0,00"),this.currentValue=0,this.interval=0,this.animationDuration=500,this.fontGrowth=10,this.fontSize=30,this.frameRate=1e3/60,this.tradeAssist.isMobile&&(this.animationDuration=200,this.frameRate=50),this.events={}}return u(e,t),e.prototype.add=function(t){return t=parseFloat(t),0!==t&&(this.stepsize=(this.currentValue-parseFloat(this.counter.text().replace(/,/,"."))+t)/(60*this.animationDuration/1e3),Math.abs(this.stepsize)<.01&&(this.stepsize=.01*(this.stepsize>0?1:-1)),this.currentValue=parseFloat(this.currentValue.toFixed(2))+parseFloat(t.toFixed(2)),this.interval||this.incrementCounter()),this.tradeAssist.cardInterfaces.length>1?this.rebalance():void 0},e.prototype.incrementCounter=function(){return Math.abs(this.currentValue-parseFloat(this.counter.text().replace(/,/,".")))>Math.abs(this.stepsize)?(this.counter.text((parseFloat(this.counter.text().replace(/,/,"."))+this.stepsize).toFixed(2).replace(/\./,",")),this.interval=window.setTimeout(this.incrementCounter.bind(this),this.frameRate)):(this.counter.text(this.currentValue.toFixed(2).replace(/\./,",")),this.interval=0)},e.prototype.reset=function(){return this.add(-1*this.currentValue)},e.prototype.rebalance=function(){var t,e,i,n,s,r,a,o,u,c,l,h;for(s=null,n=null,c=this.tradeAssist.cardInterfaces,r=0,o=c.length;o>r;r++)t=c[r],e=t.counter,null==n&&(n=e.currentValue),null==s&&(s=e.currentValue),e.currentValue<s&&(s=e.currentValue),e.currentValue>n&&(n=e.currentValue);for(i=0===s?1:Math.abs(Math.min(n/s-1,1)),l=this.tradeAssist.cardInterfaces,h=[],a=0,u=l.length;u>a;a++)t=l[a],e=t.counter,e.counter.stop().animate(e.currentValue>(n+s)/2?{color:"rgb("+(255-Math.round(255*i*(2*e.currentValue-n-s)/(n-s)))+",255,"+(255-Math.round(255*i*(2*e.currentValue-n-s)/(n-s)))+")",fontSize:Math.round(i*this.fontGrowth*(2*e.currentValue-n-s)/(n-s))+this.fontSize}:e.currentValue<(n+s)/2?{color:"rgb(255,"+(255-Math.round(255*i*(n+s-2*e.currentValue)/(n-s)))+","+(255-Math.round(255*i*(n+s-2*e.currentValue)/(n-s)))+")",fontSize:Math.round(i*this.fontGrowth*(2*e.currentValue-n-s)/(n-s))+this.fontSize}:{color:"rgb(255,255,255)",fontSize:this.fontSize}),h.push(e.fireEvent("difference",[n-s,s/(n+s)]));return h},e.prototype.isMax=function(){var t,e,i,n,s,r;for(i=null,r=this.tradeAssist.cardInterfaces,n=0,s=r.length;s>n;n++)t=r[n],e=t.counter,null==i&&(i=e.currentValue),e.currentValue>i&&(i=e.currentValue);return this.currentValue===i},e}(e)}).call(this);